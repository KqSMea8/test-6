<?php
namespace App\Library\Pay\Youzan\Open; use Exception; class Token { private $clientId; private $clientSecret; private $accessToken; private $refreshToken; private static $requestUrl = 'https://open.youzan.com/oauth/token'; public function __construct($sp9b471a, $sp0c1c74, $sp286111 = null, $spba42ff = null) { $this->clientId = $sp9b471a; $this->clientSecret = $sp0c1c74; $this->accessToken = $sp286111; $this->refreshToken = $spba42ff; } public function getToken($sp9265a0, $sp3bed73 = array()) { $sp5e6808 = array(); $sp5e6808['client_id'] = $this->clientId; $sp5e6808['client_secret'] = $this->clientSecret; if ($sp9265a0 === 'oauth') { $sp5e6808['grant_type'] = 'authorization_code'; $sp5e6808['code'] = $sp3bed73['code']; $sp5e6808['redirect_uri'] = $sp3bed73['redirect_uri']; } elseif ($sp9265a0 === 'refresh_token') { $sp5e6808['grant_type'] = 'refresh_token'; $sp5e6808['refresh_token'] = $sp3bed73['refresh_token']; } elseif ($sp9265a0 === 'self') { $sp5e6808['grant_type'] = 'silent'; $sp5e6808['kdt_id'] = $sp3bed73['kdt_id']; } elseif ($sp9265a0 === 'platform_init') { $sp5e6808['grant_type'] = 'authorize_platform'; } elseif ($sp9265a0 === 'platform') { $sp5e6808['grant_type'] = 'authorize_platform'; $sp5e6808['kdt_id'] = $sp3bed73['kdt_id']; } return $this->parseResponse(Http::post(self::$requestUrl, $sp5e6808)); } private function parseResponse($sp5fe47b) { $sp631d11 = json_decode($sp5fe47b, true); if (null === $sp631d11) { throw new Exception('response invalid, data: ' . $sp5fe47b); } return $sp631d11; } }