<?php
namespace App\Library\Pay\Fakala; use App\Library\Pay\ApiInterface; class Api implements ApiInterface { private $url_notify = ''; private $url_return = ''; private $pay_id; public function __construct($spae6a5b) { $this->url_notify = SYS_URL_API . '/pay/notify/' . $spae6a5b; $this->url_return = SYS_URL . '/pay/return/' . $spae6a5b; $this->pay_id = $spae6a5b; } function goPay($sp42f333, $sp79d97c, $spf49dcd, $spa1a573, $sp39c1e2) { if (!isset($sp42f333['gateway'])) { throw new \Exception('请填写gateway'); } if (!isset($sp42f333['api_id'])) { throw new \Exception('请填写api_id'); } if (!isset($sp42f333['api_key'])) { throw new \Exception('请填写api_key'); } include_once 'sdk.php'; $sp7c097c = new \fakala($sp42f333['gateway'], $sp42f333['api_id'], $sp42f333['api_key']); $spc21a73 = strtolower($sp42f333['payway']); $sp7c097c->goPay($spc21a73, $sp79d97c, 0, $sp39c1e2, '', $this->url_return, $this->url_notify); } function verify($sp42f333, $sp7b72fc) { $spf1c6fe = isset($sp42f333['isNotify']) && $sp42f333['isNotify']; include_once 'sdk.php'; $sp7c097c = new \fakala($sp42f333['gateway'], $sp42f333['api_id'], $sp42f333['api_key']); if ($spf1c6fe) { $sp594fbb = $sp7c097c->notify_verify(); } else { $sp594fbb = $sp7c097c->return_verify(); } if ($sp594fbb) { $sp79d97c = $_REQUEST['out_trade_no']; $sp1ae8d8 = $_REQUEST['total_fee']; $sp145625 = $_REQUEST['order_no']; $sp7b72fc($sp79d97c, $sp1ae8d8, $sp145625); } return $sp594fbb; } }