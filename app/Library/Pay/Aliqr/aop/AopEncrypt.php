<?php
function aliqr_encrypt($spf2d586, $sp4c1fef) { $sp4c1fef = base64_decode($sp4c1fef); $spf2d586 = trim($spf2d586); $spf2d586 = addPKCS7Padding($spf2d586); $sp9161ba = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $sp38fcaa = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $sp4c1fef, $spf2d586, MCRYPT_MODE_CBC); return base64_encode($sp38fcaa); } function aliqr_decrypt($spf2d586, $sp4c1fef) { $spf2d586 = base64_decode($spf2d586); $sp4c1fef = base64_decode($sp4c1fef); $sp9161ba = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $sp38fcaa = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $sp4c1fef, $spf2d586, MCRYPT_MODE_CBC); $sp38fcaa = trim($sp38fcaa); $sp38fcaa = stripPKSC7Padding($sp38fcaa); return $sp38fcaa; } function addPKCS7Padding($spa43328) { $spa43328 = trim($spa43328); $spd76a83 = mcrypt_get_block_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC); $spd79055 = $spd76a83 - strlen($spa43328) % $spd76a83; if ($spd79055 <= $spd76a83) { $sp1b6bac = chr($spd79055); $spa43328 .= str_repeat($sp1b6bac, $spd79055); } return $spa43328; } function stripPKSC7Padding($spa43328) { $spa43328 = trim($spa43328); $sp1b6bac = substr($spa43328, -1); $sp936a13 = ord($sp1b6bac); if ($sp936a13 == 62) { return $spa43328; } $spa43328 = substr($spa43328, 0, -$sp936a13); return $spa43328; }