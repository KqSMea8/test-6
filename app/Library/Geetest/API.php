<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($sp42f333) { $this->geetest_conf = $sp42f333; } public static function get() { $spae6a5b = config('services.geetest.id'); $spb5c5a0 = config('services.geetest.key'); if (!strlen($spae6a5b) || !strlen($spb5c5a0)) { return null; } $sp603241 = new Lib($spae6a5b, $spb5c5a0); $sp203bcb = time() . rand(1, 10000); $sp17830c = $sp603241->pre_process($sp203bcb); $sp7210a9 = json_decode($sp603241->get_response_str()); Session::put('gt_server', $sp17830c); Session::put('gt_user_id', $sp203bcb); return $sp7210a9; } public static function verify($spff4449, $sp052c66, $spbcdc2f) { $sp603241 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $sp203bcb = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $sp594fbb = $sp603241->success_validate($spff4449, $sp052c66, $spbcdc2f, $sp203bcb); if ($sp594fbb) { return true; } else { return false; } } else { if ($sp603241->fail_validate($spff4449, $sp052c66, $spbcdc2f)) { return true; } else { return false; } } } }